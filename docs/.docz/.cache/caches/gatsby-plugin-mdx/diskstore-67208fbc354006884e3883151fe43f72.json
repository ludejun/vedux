{"expireTime":9007200832018569000,"key":"gatsby-plugin-mdx-entire-payload-d44691e736fcda91080978dd8d11d720-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/ludejun/ludejun/vedux/docs/node_modules/@wmfe/gatsby-theme-pocket/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":120,"offset":121},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":123},"end":{"line":5,"column":29,"offset":151},"indent":[]}},{"type":"import","value":"import { PromptText } from '@wmfe/pocket-components/PromptText'","position":{"start":{"line":8,"column":1,"offset":154},"end":{"line":8,"column":64,"offset":217},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"快速接入","position":{"start":{"line":10,"column":3,"offset":221},"end":{"line":10,"column":7,"offset":225},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":219},"end":{"line":10,"column":7,"offset":225},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"yarn add @wmfe/vedux","position":{"start":{"line":12,"column":1,"offset":227},"end":{"line":14,"column":4,"offset":260},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"安装之后：","position":{"start":{"line":16,"column":1,"offset":262},"end":{"line":16,"column":6,"offset":267},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":262},"end":{"line":16,"column":6,"offset":267},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Step 1：创建store，纯粹redux API","position":{"start":{"line":18,"column":4,"offset":272},"end":{"line":18,"column":30,"offset":298},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":269},"end":{"line":18,"column":30,"offset":298},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"store.js","position":{"start":{"line":20,"column":1,"offset":300},"end":{"line":20,"column":9,"offset":308},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":300},"end":{"line":20,"column":9,"offset":308},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"const {\n  createStore,\n  // applyMiddleware,\n  // compose,\n} = require('redux');\n\nconst reducer = require('./reducers'); // reducer聚合文件\n\nconst store = createStore(\n  reducer,\n);\n\nmodule.exports = store;","position":{"start":{"line":21,"column":1,"offset":309},"end":{"line":35,"column":4,"offset":529},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Step 2：app上绑定store","position":{"start":{"line":37,"column":4,"offset":534},"end":{"line":37,"column":22,"offset":552},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":531},"end":{"line":37,"column":22,"offset":552},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"app.js","position":{"start":{"line":39,"column":1,"offset":554},"end":{"line":39,"column":7,"offset":560},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":554},"end":{"line":39,"column":7,"offset":560},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"import { Provider } from 'vedux';\nimport store from './store';\n\nconst config = Provider(store)({\n  onLaunch() {\n    // TODO\n  },\n});\n\nApp(config);","position":{"start":{"line":40,"column":1,"offset":561},"end":{"line":51,"column":4,"offset":725},"indent":[1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Step 3：在页面上绑定store，比如首页，写法和redux类似","position":{"start":{"line":53,"column":4,"offset":730},"end":{"line":53,"column":38,"offset":764},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":727},"end":{"line":53,"column":38,"offset":764},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"pages/index/index.js","position":{"start":{"line":55,"column":1,"offset":766},"end":{"line":55,"column":21,"offset":786},"indent":[]}}],"position":{"start":{"line":55,"column":1,"offset":766},"end":{"line":55,"column":21,"offset":786},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"import { connect } from 'vedux';\nimport { fetchAPI } from '../../actions/home'; // 下面创建\n\nconst pageConfig = {\n  data: {\n    motto: 'Hello World!',\n    userInfo: {},\n  },\n  onLoad() {\n    // 异步触发1次，最终态Hello Vedux!\n    this.fetchAPI({motto: 'Hello Vedux!'})\n  },\n};\n\nconst mapStateToData = ({user, home}) => {\n  return {\n    userInfo: user.userInfo,\n    motto: home.motto,\n  };\n};\n\nconst mapDispatchToPage = dispatch => ({\n  storeUserInfo: userInfo => {\n    dispatch(storeUserInfo(userInfo));\n  },\n  fetchAPI: (payload) => {\n    // action第二个参数是callback，当这次action引起data变更后触发\n    dispatch(fetchAPI(payload, () => {\n      // TODO\n    }))\n  },\n});\n\nPage(connect(\n  mapStateToData,\n  mapDispatchToPage,\n)(pageConfig));","position":{"start":{"line":56,"column":1,"offset":787},"end":{"line":94,"column":4,"offset":1516},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Step 4：创建redux数据流中的模版文件：action、reducer","position":{"start":{"line":96,"column":4,"offset":1521},"end":{"line":96,"column":42,"offset":1559},"indent":[]}}],"position":{"start":{"line":96,"column":1,"offset":1518},"end":{"line":96,"column":42,"offset":1559},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"actions/home.js","position":{"start":{"line":98,"column":1,"offset":1561},"end":{"line":98,"column":16,"offset":1576},"indent":[]}}],"position":{"start":{"line":98,"column":1,"offset":1561},"end":{"line":98,"column":16,"offset":1576},"indent":[]}},{"type":"code","lang":"js","meta":null,"value":"export const types = {\n  HOME_FETCH_API: 'HOME_FETCH_API',\n};\n\nexport function fetchAPI(payload, cb, options) {\n  return {\n    type: types.HOME_FETCH_API,\n    payload,\n  };\n}","position":{"start":{"line":99,"column":1,"offset":1577},"end":{"line":110,"column":4,"offset":1761},"indent":[1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"reducers/home.js","position":{"start":{"line":112,"column":1,"offset":1763},"end":{"line":112,"column":17,"offset":1779},"indent":[]}}],"position":{"start":{"line":112,"column":1,"offset":1763},"end":{"line":112,"column":17,"offset":1779},"indent":[]}},{"type":"code","lang":"js","meta":null,"value":"import { types } from '../actions/home';\n\nconst initialState = {\n  motto: null,\n};\n\nexport default function user(state = initialState, action = {}) {\n  switch (action.type) {\n    case types.HOME_FETCH_API:\n      return {\n        ...state,\n        motto: action.payload.motto,\n      };\n\n    default:\n      return state;\n  }\n}","position":{"start":{"line":113,"column":1,"offset":1780},"end":{"line":132,"column":4,"offset":2114},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"最后","position":{"start":{"line":135,"column":4,"offset":2120},"end":{"line":135,"column":6,"offset":2122},"indent":[]}}],"position":{"start":{"line":135,"column":1,"offset":2117},"end":{"line":135,"column":6,"offset":2122},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"这样redux数据流就跑下来了，可以通过绑定在app上的store来控制全局状态的页面更新，通过mapStateToData可以将变化之后的state打到页面的data中，并自动让页面刷新。dispatch导致的页面data变化默认不是同步的。当然也有些场景，比如登录后，dispatch必须为同步可以参考后续API文档或者高阶使用文档。","position":{"start":{"line":137,"column":1,"offset":2124},"end":{"line":137,"column":170,"offset":2293},"indent":[]}}],"position":{"start":{"line":137,"column":1,"offset":2124},"end":{"line":137,"column":170,"offset":2293},"indent":[]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":140,"column":1,"offset":2296},"end":{"line":140,"column":31,"offset":2326},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":140,"column":31,"offset":2326}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/ludejun/ludejun/vedux/docs/node_modules/@wmfe/gatsby-theme-pocket/src/base/Layout.js\"\nimport { PromptText } from '@wmfe/pocket-components/PromptText'\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n    <h1 {...{\n      \"id\": \"快速接入\"\n    }}>{`快速接入`}</h1>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`yarn add @wmfe/vedux\n`}</code></pre>\n    <p>{`安装之后：`}</p>\n    <h2 {...{\n      \"id\": \"step-1：创建store，纯粹redux-api\"\n    }}>{`Step 1：创建store，纯粹redux API`}</h2>\n    <p>{`store.js`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`const {\n  createStore,\n  // applyMiddleware,\n  // compose,\n} = require('redux');\n\nconst reducer = require('./reducers'); // reducer聚合文件\n\nconst store = createStore(\n  reducer,\n);\n\nmodule.exports = store;\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"step-2：app上绑定store\"\n    }}>{`Step 2：app上绑定store`}</h2>\n    <p>{`app.js`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`import { Provider } from 'vedux';\nimport store from './store';\n\nconst config = Provider(store)({\n  onLaunch() {\n    // TODO\n  },\n});\n\nApp(config);\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"step-3：在页面上绑定store，比如首页，写法和redux类似\"\n    }}>{`Step 3：在页面上绑定store，比如首页，写法和redux类似`}</h2>\n    <p>{`pages/index/index.js`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`import { connect } from 'vedux';\nimport { fetchAPI } from '../../actions/home'; // 下面创建\n\nconst pageConfig = {\n  data: {\n    motto: 'Hello World!',\n    userInfo: {},\n  },\n  onLoad() {\n    // 异步触发1次，最终态Hello Vedux!\n    this.fetchAPI({motto: 'Hello Vedux!'})\n  },\n};\n\nconst mapStateToData = ({user, home}) => {\n  return {\n    userInfo: user.userInfo,\n    motto: home.motto,\n  };\n};\n\nconst mapDispatchToPage = dispatch => ({\n  storeUserInfo: userInfo => {\n    dispatch(storeUserInfo(userInfo));\n  },\n  fetchAPI: (payload) => {\n    // action第二个参数是callback，当这次action引起data变更后触发\n    dispatch(fetchAPI(payload, () => {\n      // TODO\n    }))\n  },\n});\n\nPage(connect(\n  mapStateToData,\n  mapDispatchToPage,\n)(pageConfig));\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"step-4：创建redux数据流中的模版文件：action、reducer\"\n    }}>{`Step 4：创建redux数据流中的模版文件：action、reducer`}</h2>\n    <p>{`actions/home.js`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`export const types = {\n  HOME_FETCH_API: 'HOME_FETCH_API',\n};\n\nexport function fetchAPI(payload, cb, options) {\n  return {\n    type: types.HOME_FETCH_API,\n    payload,\n  };\n}\n`}</code></pre>\n    <p>{`reducers/home.js`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`import { types } from '../actions/home';\n\nconst initialState = {\n  motto: null,\n};\n\nexport default function user(state = initialState, action = {}) {\n  switch (action.type) {\n    case types.HOME_FETCH_API:\n      return {\n        ...state,\n        motto: action.payload.motto,\n      };\n\n    default:\n      return state;\n  }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"最后\"\n    }}>{`最后`}</h2>\n    <p>{`这样redux数据流就跑下来了，可以通过绑定在app上的store来控制全局状态的页面更新，通过mapStateToData可以将变化之后的state打到页面的data中，并自动让页面刷新。dispatch导致的页面data变化默认不是同步的。当然也有些场景，比如登录后，dispatch必须为同步可以参考后续API文档或者高阶使用文档。`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}